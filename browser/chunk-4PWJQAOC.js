import{L as p,P as o,cc as g,d as n,dc as d,ec as f,fc as E,gc as v,ic as y,mc as a,nc as l,pc as u,qc as c,rc as h,sc as m,tc as b}from"./chunk-CZGCKYO5.js";var C=class i{auth=o(y);firestore=o(b);currentEmail=null;constructor(){}setCurrentEmail(t){this.currentEmail=t}getCurrentEmail(){return this.auth.currentUser?.email||null}register(t){return d(this.auth,t.email,t.password).then(e=>{this.setCurrentEmail(t.email);let r=e.user.uid,s=l(this.firestore,"users",r);return m(s,{email:t.email,dni:t.dni,nombreCompleto:t.nombreCompleto})})}login(t){return f(this.auth,t.email,t.password).then(e=>(this.setCurrentEmail(e.user.email),e))}loginWithGoogleOnly(){let t=new g;return v(this.auth,t).then(e=>(this.setCurrentEmail(e.user.email),e))}userExistsInFirestore(t){return n(this,null,function*(){let e=u(a(this.firestore,"users"),c("email","==",t));return!(yield h(e)).empty})}dniExistsInFirestore(t){return n(this,null,function*(){let e=u(a(this.firestore,"users"),c("dni","==",t));return!(yield h(e)).empty})}saveUserData(t,e,r,s){return n(this,null,function*(){let w=l(this.firestore,"users",t);return m(w,{email:e,dni:r,nombreCompleto:s})})}logout(){return E(this.auth).then(()=>{this.setCurrentEmail(null)})}isAuthenticated(){return this.auth.currentUser!==null}validateDniLetter(t){if(!t||!/^\d{8}[A-Za-z]$/.test(t))return!1;let e=parseInt(t.substring(0,8),10);return t.charAt(8).toUpperCase()==="TRWAGMYFPDXBNJZSQVHLCKE".charAt(e%23)}static \u0275fac=function(e){return new(e||i)};static \u0275prov=p({token:i,factory:i.\u0275fac,providedIn:"root"})};export{C as a};
